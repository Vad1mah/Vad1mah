<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title></title>
</head>
    <style type="text/css">
        body,
        html {
            width: 100%;
            height: 100%;
            margin: 0;
            padding: 0;
        }

        * {
            box-sizing: border-box;
        }
        .pictures {
            display: flex;
            width: 100%;
            height: 100%;
        }
        .pictures__choose {
            width: 50%;
            height: 100%;
            background-color: #859ca6;
        }
        .pictures__drop {
            display: flex;
            width: 50%;
            height: 100%;
            background-color: #D2E9EE;
            justify-content: center;
            align-items: center;
        }
        .drop__grid {
            display: grid;
            grid-template-rows: repeat(6, 50px);
            width: 450px;
            height: 300px;
            border-collapse: collapse;
        }
        .grid__row {
            display: grid;
            grid-template-columns: repeat(9, 50px);
        }
        .grid__cell {
            box-sizing: content-box;
            width: 50px;
            height: 50px;
            border: 1px solid #707070;
            background-color: #e9e9e9;
            justify-content: center;
            align-items: center;
            align-self: auto;
        }
        .grid__cell--picture {
            position: absolute;
            width: 50px;
            height: 50px;
            background: url(./images/image.jpg);
            background-repeat: no-repeat;
            background-position: 0px 0px;
            border: 1px solid #FFFFFF;
        }

    </style>

<body>
    <div class="pictures">
        <div class="pictures__choose">

        </div>
        <div class="pictures__drop">
            <div class="drop__grid">
                <div class="grid__row">
                    <div class="grid__cell">
                        
                    </div>
                    <div class="grid__cell">
                        
                    </div>
                    <div class="grid__cell">
                        
                    </div>
                    <div class="grid__cell">
                        
                    </div>
                    <div class="grid__cell">
                        
                    </div>
                    <div class="grid__cell">
                        
                    </div>
                    <div class="grid__cell">
                        
                    </div>
                    <div class="grid__cell">
                        
                    </div>
                    <div class="grid__cell">
                        
                    </div>
                </div>
                <div class="grid__row">
                    <div class="grid__cell">
                        
                    </div>
                    <div class="grid__cell">
                        
                    </div>
                    <div class="grid__cell">
                        
                    </div>
                    <div class="grid__cell">
                        
                    </div>
                    <div class="grid__cell">
                        
                    </div>
                    <div class="grid__cell">
                        
                    </div>
                    <div class="grid__cell">
                        
                    </div>
                    <div class="grid__cell">
                        
                    </div>
                    <div class="grid__cell">
                        
                    </div>
                </div>
                <div class="grid__row">
                    <div class="grid__cell">
                        
                    </div>
                    <div class="grid__cell">
                        
                    </div>
                    <div class="grid__cell">
                        
                    </div>
                    <div class="grid__cell">
                        
                    </div>
                    <div class="grid__cell">
                        
                    </div>
                    <div class="grid__cell">
                        
                    </div>
                    <div class="grid__cell">
                        
                    </div>
                    <div class="grid__cell">
                        
                    </div>
                    <div class="grid__cell">
                        
                    </div>
                </div>
                <div class="grid__row">
                    <div class="grid__cell">
                        
                    </div>
                    <div class="grid__cell">
                        
                    </div>
                    <div class="grid__cell">
                        
                    </div>
                    <div class="grid__cell">
                        
                    </div>
                    <div class="grid__cell">
                        
                    </div>
                    <div class="grid__cell">
                        
                    </div>
                    <div class="grid__cell">
                        
                    </div>
                    <div class="grid__cell">
                        
                    </div>
                    <div class="grid__cell">
                        
                    </div>
                </div>
                <div class="grid__row">
                    <div class="grid__cell">
                        
                    </div>
                    <div class="grid__cell">
                        
                    </div>
                    <div class="grid__cell">
                        
                    </div>
                    <div class="grid__cell">
                        
                    </div>
                    <div class="grid__cell">
                        
                    </div>
                    <div class="grid__cell">
                        
                    </div>
                    <div class="grid__cell">
                        
                    </div>
                    <div class="grid__cell">
                        
                    </div>
                    <div class="grid__cell">
                        
                    </div>
                </div>
                <div class="grid__row">
                    <div class="grid__cell">
                        
                    </div>
                    <div class="grid__cell">
                        
                    </div>
                    <div class="grid__cell">
                        
                    </div>
                    <div class="grid__cell">
                        
                    </div>
                    <div class="grid__cell">
                        
                    </div>
                    <div class="grid__cell">
                        
                    </div>
                    <div class="grid__cell">
                        
                    </div>
                    <div class="grid__cell">
                        
                    </div>
                    <div class="grid__cell">
                        
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script>
        (function () {

            createPictures()

            let block = document.querySelector('.pictures');
            let pictureArea = document.querySelector('.pictures .pictures__choose');
            let zIndexNum = 1000;

            block.addEventListener('mousedown', e => {
                let target = e.target;
                
                if (target.classList.contains('block')) {
                    target.style.zIndex = zIndexNum;
                    
                    target.hidden = true;
                    let droppableBelowStart = document.elementFromPoint(e.clientX, e.clientY).closest('.grid__cell');
                    target.hidden = false;

                    let x = e.x, y = e.y;
                    let targetX = target.offsetLeft;
                    let targetY = target.offsetTop;

                    let trackMove = e => {
                        e.preventDefault()
                        let cx = e.x, cy = e.y;
                        let dx = cx - x, dy = cy - y;
                        let nx = targetX + dx, ny = targetY + dy;
                        if (nx < 0) {
                            nx = 0;
                        }
                        if (ny < 0) {
                            ny = 0;
                        }
                        if (nx > block.offsetWidth - target.offsetWidth) {
                            nx = block.offsetWidth - target.offsetWidth;
                        }
                        if (ny > block.offsetHeight - target.offsetHeight) {
                            ny = block.offsetHeight - target.offsetHeight;
                        }

                        
                        target.style.position = 'absolute';
                        target.style.left = nx + 'px';
                        target.style.top = ny + 'px';
                        
                    };
                    let release = e => {
                        window.removeEventListener('mousemove', trackMove);
                        window.removeEventListener('mouseup', release);
                        zIndexNum++;

                        let currentDroppable = null;

                        target.hidden = true;
                        let elemBelow = document.elementFromPoint(e.clientX, e.clientY);
                        target.hidden = false;
                        
                        if (!elemBelow) return;
                        
                        let droppableBelowEnd = elemBelow.closest('.grid__cell');
                        
                        if (currentDroppable != droppableBelowEnd && droppableBelowEnd.querySelectorAll('.block').length < 1) {
                            currentDroppable = droppableBelowEnd;
                            enterDroppable(currentDroppable, target);
                        } else if (droppableBelowStart != droppableBelowEnd) {
                            leaveDroppable(droppableBelowStart, target, pictureArea);
                        } else if (currentDroppable = droppableBelowEnd){
                            enterDroppable(currentDroppable, target);
                        }      
                    }
                    window.addEventListener('mousemove', trackMove);
                    window.addEventListener('mouseup', release);
                }
            });

        })();
        
        function createPictures() {
            let picturesArea = document.querySelector('.pictures .pictures__choose');
            for (let i = 0; i <= 53; i++) {
                let picture = document.createElement('div');
                picture.classList.add('block', 'grid__cell--picture');
                picture.style.backgroundPosition = -50 * (i % 9) + 'px ' + -50 * Math.floor(i / 9) + 'px';
                //picture.style.left = 50 * (i % 9) + 'px';
                //picture.style.top = 50 * Math.floor(i / 9) + 'px';
                picture.style.left = getRandomInt(50, 800) + 'px';
                picture.style.top = getRandomInt(150, 750) + 'px';
                picturesArea.append(picture);
            }
        }

        function enterDroppable(cell, picture) {
            cell.append(picture);
            picture.style.position = 'relative';
            picture.style.left = '0px';
            picture.style.top = '0px';
        }   

        function leaveDroppable(cell, picture, area) {
            picture.remove()
            area.append(picture)
        }

        function getRandomInt(min, max) {
            return Math.floor(Math.random() * (max - min)) + min;
        }

    </script>
</body>
</html>